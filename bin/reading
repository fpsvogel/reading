#!/usr/bin/env ruby

# A script that provides a quick way to see the output of a CSV string.
#
# Usage:
# Run on the command line:
#   reading "<CSV string>" "<optional comma-separated names of enabled columns>"
#
# Examples:
#   reading '3|ðŸ“•Trying|Little Library 1970147288'
#   reading 'ðŸ“•Trying|Little Library 1970147288' 'head, sources'


require_relative "../lib/reading"
require "amazing_print"
require "debug"

input = ARGV[0]
unless input
  raise ArgumentError, "CSV string argument required, such as '3|ðŸ“•Trying|Little Library 1970147288'"
end

config = {}
if ARGV[1]
  enabled_columns = ARGV[1].split(",").map(&:strip).map(&:to_sym)
  config = { enabled_columns: }
end

items = Reading.parse(stream: input, config:, hash_output: true)

ap items
